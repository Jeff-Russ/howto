--------------------------------------------------------------------------------

# RAILS 1. SETUP
  
--------------------------------------------------------------------------------
### 1.1 Generate the App

#### Set up environment with specified ruby and rails versions:

> To check Ruby and rails version:
	
		$ ruby -v
		$ rails -v
	
__To install Ruby and Rails specific version and create app:__

		$ gem uninstall rails
		$ gem uninstall railties
		$ gem install rails -v 4.1.0
		$ rails _4.1.0_ new MySite   # generate web app dir and files
	
> Specifying the version number it only needed if you have more than one installed.  
> If you want mySQL locally, run: `$ rails new MySite -d mysql`  
		
__To install latest Ruby and Rails and create app__

		$ gem install rails
		$ rails new MySite   # generate web app dir and files
		
--------------------------------------------------------------------------------
### 1.2 Install Gem Add-Ons
	
> Rails uses add-ons called Gems which you can specify in the file called Gemfile. 
This file already has recommended gems listed in it, ready to install with the 
following command:

		$ cd <project/root/directory/>
		$ bundle update    # do this step only if the next one does not work alone
		$ bundle install --without production		# has remembered option
	
> This remembered option means the next time you run `bundle install` it will retain.  
> Beware the running things like `bundle update` `bundle install`  and  
`bundle exec` will work without `bundle` but `bundle` insures that you run the  
version used by your app project! Therefore it's much safer to prepend with it. 
   
> If you want to verify what has been installed you can run

		$ gem list rails 	# to view only the rails gems
		$ gem list 			# to list all gems
		
__Customize Gemfile__
	
> Take a look at the Gemfile you just installed from. 

> If you use a Gemfile that was not generated by your install it must show the  
same rails version as the one you have intalled on your system. You can have  
multiple versions intalled and the Gemfile with dictate which version your app  
will use.  

> Typically version numbers in Gemfiles are given as ranges but for learning it's good  
to have exact version numbers. This means removing all ~> and >= from this file.  

> here is the complete Gemfile as used in a project running Rails 4.1.0:

		source 'https://rubygems.org'
		
		
		gem 'rails', '4.1.0' # Bundle edge Rails instead: gem 'rails', github: 'rails/rails'
		gem 'sqlite3', group: [:development, :test] 		# Use sqlite3 as db for Active Record
		
		# Use postgresql as the database for production
		group :production do
		  gem 'pg'
		  gem 'rails_12factor'
		end
		
		# See https://github.com/sstephenson/execjs#readme for more supported runtimes
		# gem 'therubyracer',  platforms: :ruby 
		
		# Turbolinks makes following links in your web application faster. Read more: https://github.com/rails/turbolinks
		# gem 'turbolinks'
		
		gem 'sass-rails', '4.0.3'				# Use SCSS for stylesheets
		gem 'bootstrap-sass', '3.3.1'			# Use bootstrap library for styles
		gem 'font-awesome-sass', '4.2.0'		# Use font awesome library for icons
		
		gem 'uglifier', '1.3.0'					# Compressor for JavaScript assets
		gem 'coffee-rails', '4.0.0' 			# Use .js.coffee assets and views
		gem 'jquery-rails'						# Use jquery as JavaScript library
		gem 'jbuilder', '2.0'					# Build JSON APIs with ease
		gem 'sdoc', '0.4.0', group: :doc		# bundle exec rake doc:rails generates the API under doc/api.
		gem 'spring',   group: :development	# speeds up dev by keeping app running in the bg. 
		
		gem 'devise', '3.4.1'					# Use devise for user auth
		# gem 'bcrypt', '3.1.7'					# Use ActiveModel has_secure_password
		
		gem 'stripe', '1.16.1'					# Use stripe for handling payments
		gem 'figaro', '1.0.0'					# Use figaro to hide secret keys
		
		gem 'paperclip', '4.2.1'				# Use paperclip for image uploads
		# gem 'aws-sdk-v1' # For Amazon's S3 service If using paperclip <= v4.3.1
		
		gem 'redcarpet', '~> 2.1.1' 			# for markdown support
		gem 'coderay', '~> 1.0.7'				# for markdown support
		
--------------------------------------------------------------------------------
### 1.3 Launch Site Locally

> Now let's launch the site privately:

		$ rails server -p 808						  # Do this for local machines
		$ bundle exec rails server -p $PORT -b $IP 	# Do this for cloud9
	
> You can grab the URL and open it anywhere else. When you are done coding you may  
want to take it down by being in the terminal and hitting ctrl-c  
If you ever need to know your IP address and/or your port you can...  

		$ echo $IP
		$ echo $PORT
	
--------------------------------------------------------------------------------
### 1.4 Setup Git Source Control

> First make a Github or Bitbucket account and VERIFY YOUR EMAIL. 

> Make sure your email address below is the same as you used with your Github or Bitbucket 
account. I don't think it matters if usernames match. When doing anything with git  
always make sure you are at the project root. Do the following only once per computer: 

		$ cd <project/root/directory/>  
		$ git config --global user.name "Your Name"
		$ git config --global user.email "your@email.com"
		$ git config --global push.default matching
		$ cat ~/.ssh/id_rsa.pub			# copy entire key.  
										
> Go to Github and click on settings for your profile. Click SSH keys and add key from above.  
Now for the things done per-project...   						      

> Make a repository on Github. You'll probably want it to have the same name as your app.  
Choose not to make a README.md. After you submit, on the next screen click SSH and copy.  
Before we connect our local file to Github we need to have git setup locally:  

		$ cd <project/root/directory/> 
		$ git init		# this generates the git control files and folders
		
> Rails uses .rdoc for readme files which is not what Github uses. Change the 
extension:

	$ git mv README.rdoc README.md
		
> Before we start tracking our code we want to ignore certain files that have 
sensitive data, expecially if we have a public repo on Github. Even if the files 
don't yet exist, adding the following to the hidden file .gitignore will prevent 
them from ever being uploaded. 

> See https://help.github.com/articles/ignoring-files for more about ignoring files.  

		# TODO Comment out if OK with secrets being uploaded to the repo
		config/initializers/secret_token.rb
		config/secrets.yml

		# Ignore application configuration
		/config/application.yml

> If you find yourself ignoring temporary files generated by your text editor  
or operating system, you probably want to add a global ignore instead:  

		$ git config --global core.excludesfile '~/.gitignore_global'
		
> Now lets add and commit the project locally.
	
		$ git add .    # dot adds everything to the local version control 
		$ git status	# to view everything that was added
		$ git commit -m "Initial commit"	# This commits everything locally
		
> Next you get set the origin to be the version online. This mean two things: we connect  
the local with online and we declare the online to be the "origin." The address  
we type in below is the copied SSH not HTML. This means we don't have to keep logging on. 

		### always in project root directory!!  
		$ git remote add origin git@github.com:yourusername/MySite.git # copied from SSH
		$ git remote					# to verify. you should see origin
		$ git push origin master	# This uploads our prior commits to the online repo
	
> Consider the master branch to be the one that is completed and deployed.  
In addition to master you should have one called dev. Beyond development  
You should make a branch any time you make a new addition to the site and once  
you're sure it's a good idea, merge it into dev. When it seems to be a  
good time, merge dev to master and deploy. Only deploy from master. 

		$ git checkout -b dev 	# makes new branch as copy of current one
		$ git add .             # . adds all
		$ git push origin dev 	# make the development branch at Github
	
> If you don't want to save your changes to the branch you are currently on you  
can switch to a NEW branch and save the current state there. If it is not a new  
branch, git will not allow you to switch unless you commit changes in the current  
branch. 

		$ git checkout -b new_branch
		$ git add .
		$ git commit -m 'Questionable changes'
		$ git checkout development
				# later if you want to delete it:
		$ git branch -D new_branch
		
> Deleted files are not updated with `git add .` so if you want to update any 
deleted files you should use git to remove them or run `git add . -A`
		
> If you are sure you want to revert to the previous commit:

		$ git checkout -f
		
**Your daily workflow routine**
	
> To preview site on c9.io...  

		$ bundle exec rails server  -p $PORT -b $IP   # ctrl-c to take down preview 
	
> Keep server running. Open new terminal tab...  

		### in project root directory:  
		$ git status                # If you see changes that you want to commit
		$ git add . -A              # add all and update deleted files (if needed)
		$ git status                # check if it was added
		$ git commit -m "YOUR MSG"  # github commit
		$ git push origin <branch>  # push to github
		

